server             = false
datacenter         = "dc1"
primary_datacenter = "dc1"
node_name          = "{{ NODE_NAME }}"
partition          = "default"

acl {
  enabled                  = true
  default_policy           = "deny"
  enable_token_persistence = true
  tokens {
    agent = "{{ CONSUL_CLIENT_TOKEN }}"
  }
}

ports {
  http  = 8500
  https = 8501
  grpc  = 8502
}

encrypt                 = "{{ CONSUL_GOSSIP_ENCRYPTION_KEY }}"
encrypt_verify_incoming = true
encrypt_verify_outgoing = true

tls {
  defaults {
    ca_file         = "/etc/consul.d/consul-agent-ca.pem"
    cert_file       = "/etc/consul.d/dc1-client-consul-0.pem"
    key_file        = "/etc/consul.d/dc1-client-consul-0-key.pem"
    verify_incoming = false
    verify_outgoing = true
  }
  internal_rpc {
    verify_incoming        = true
    verify_server_hostname = false
  }
}

data_dir    = "{{ CONSUL_DATA_PATH }}"
bind_addr   = "{{ BIND_ADDR }}"
client_addr = "127.0.0.1"

retry_join = ["{{ RETRY_JOIN }}"]

log_level     = "INFO"
enable_syslog = true

connect {
  enabled = true
}